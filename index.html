<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Gestão de OS e Tarefas - Horas Trabalhadas</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="assets/css/styles.css" />
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.8.2"></script>
  </head>
  <body>
    <header class="app-header">
      <div class="brand">
        <div class="logo-upload">
          <label for="companyLogo" class="logo-label">
            <span>Logo da Empresa</span>
            <input id="companyLogo" type="file" accept="image/*" />
          </label>
          <img id="logoPreview" alt="Logo Preview" />
        </div>
        <div class="company-info">
          <div class="field-group">
            <label for="orderId">ID da OS</label>
            <input type="text" id="orderId" placeholder="Ex.: OS-2025-001" />
          </div>
          <div class="field-group">
            <label for="companyName">Nome da Empresa</label>
            <input type="text" id="companyName" placeholder="Ex.: ACME Ltda." />
          </div>
        </div>
      </div>
      <div class="actions-row">
        <button id="newOrderBtn" class="btn ghost">Nova OS</button>
        <button id="saveOrderBtn" class="btn primary">Salvar OS</button>
      </div>
    </header>

    <main class="container">
      <section class="card">
        <h2>Cadastro de Tarefa</h2>
        <form id="taskForm" class="grid-form" autocomplete="off">
          <div class="field-group">
            <label for="responsibleName">Responsável</label>
            <input id="responsibleName" type="text" placeholder="Nome completo" required />
          </div>
          <div class="field-group">
            <label for="department">Setor</label>
            <input id="department" type="text" placeholder="Ex.: TI, Suporte, Dev" />
          </div>
          <div class="field-group">
            <label for="activity">Atividade/Demanda</label>
            <input id="activity" type="text" placeholder="Título curto da atividade" required />
          </div>
          <div class="field-group field-wide">
            <label for="description">Descrição detalhada</label>
            <textarea id="description" rows="3" placeholder="Descreva a atividade"></textarea>
          </div>

          <div class="field-group">
            <label for="startDate">Início</label>
            <input id="startDate" type="date" required />
          </div>
          <div class="field-group">
            <label for="endDate">Finalização</label>
            <input id="endDate" type="date" required />
          </div>
          <div class="field-group">
            <label for="businessDays">Dias úteis</label>
            <input id="businessDays" type="number" min="0" step="1" readonly />
          </div>
          <div class="field-group">
            <label for="hours">Horas da atividade</label>
            <input id="hours" type="number" min="0" step="0.25" placeholder="Ex.: 6" required />
          </div>
          <div class="field-group">
            <label for="status">Status</label>
            <select id="status">
              <option value="planejada">Planejada</option>
              <option value="em_andamento">Em andamento</option>
              <option value="concluida">Concluída</option>
              <option value="bloqueada">Bloqueada</option>
            </select>
          </div>
          <div class="field-group field-wide align-end">
            <button type="submit" class="btn primary">Adicionar tarefa</button>
          </div>
        </form>
      </section>

      <section class="card">
        <div class="card-header">
          <h2>Tarefas da OS</h2>
          <div class="right">
            <button id="clearTasksBtn" class="btn danger ghost">Limpar tarefas</button>
          </div>
        </div>
        <div class="table-wrapper">
          <table id="tasksTable">
            <thead>
              <tr>
                <th>#</th>
                <th>Responsável</th>
                <th>Setor</th>
                <th>Atividade</th>
                <th>Descrição</th>
                <th>Início</th>
                <th>Fim</th>
                <th>Dias úteis</th>
                <th>Horas</th>
                <th>Status</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody></tbody>
            <tfoot>
              <tr>
                <td colspan="7" class="align-right">Totais</td>
                <td id="totalBusinessDays">0</td>
                <td id="totalHours">0</td>
                <td colspan="2"></td>
              </tr>
            </tfoot>
          </table>
        </div>
      </section>

      <section class="card">
        <h2>Exportar e Compartilhar</h2>
        <div class="export-actions">
          <button id="exportExcelBtn" class="btn">Exportar Excel</button>
          <button id="exportPdfBtn" class="btn">Exportar PDF</button>
        </div>
        <div class="share-row">
          <div class="field-group">
            <label for="whatsNumber">Enviar WhatsApp (opcional)</label>
            <input id="whatsNumber" type="tel" placeholder="Ex.: 5591999999999" />
          </div>
          <button id="sendWhatsBtn" class="btn icon-btn" title="Enviar via WhatsApp" aria-label="Enviar via WhatsApp">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.05 11.5A8.5 8.5 0 1 1 12.5 3a8.5 8.5 0 0 1 8.55 8.5Z"/><path d="m2 22 1.5-5.5L8 18.5"/><path d="M16 12.5c-.5 1.5-3 2.5-3 2.5s-3-1-4-2.5-1.5-3-1.5-3 1.5-.5 2-.5 1 .5 1 1-.5 1-1 1"/></svg>
          </button>
        </div>

        <div class="share-row">
          <div class="field-group">
            <label for="emailTo">Enviar Email (opcional)</label>
            <input id="emailTo" type="email" placeholder="email@exemplo.com" />
          </div>
          <button id="sendEmailBtn" class="btn icon-btn" title="Enviar por email" aria-label="Enviar por email">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16v16H4z"/><path d="m22 6-10 7L2 6"/></svg>
          </button>
        </div>
      </section>
    </main>

    <footer class="app-footer">
      <span> <span id="year"></span> Gestão de OS</span>
    </footer>

    <script src="assets/js/holidays-br.js"></script>
    <script src="assets/js/app.js"></script>
  </body>
  </html>
